---
title: "Final Project"
output: html_notebook
authors: "Evelyn Murray and Joseph Pevner"
---

```{r}
library(mosaic)
library(tidyverse)
library(lubridate)
library(DataComputing)
library(rvest)
library(broom)
```

## Research Focus:

As COVID-19 spreads at an alarming rate, a pressing question at a global scale emerges-- what factors of a country contribute to the spread of Coronavirus. The factors which we will analyze are: population density, and proximity to origin point (China).


## Data Access

Reading in the Data:


Data Source 1: COVID
```{r}
COVID <- read.csv(file = "total-covid-cases-deaths-per-million.csv")
COVID
```

```{r}
COVID %>%
  nrow()
```
```{r}
COVID %>%
  names()
```
```{r}
COVID %>%
  head()
```



Data Source 2: CountryData
```{r}
CountryData
```

```{r}
CountryData %>%
  nrow()
```
```{r}
CountryData %>%
  names()
```
```{r}
CountryData %>%
  head()
```



Data Source 3: Continents
```{r}
Continents <- read.csv(file = "countries and continents.csv")
Continents
```
```{r}
Continents %>%
  nrow()
```
```{r}
Continents %>%
  names()
```
```{r}
Continents %>%
  head()
```




### Data Wrangling of COVID Dataset

```{r}
COVID
```

Since we are soley focused on the spread of COVID-19, filter out death count.

```{r}
TidyCOVID <- COVID %>%
  rename(country = total.covid.cases.deaths.per.million ) %>%
  rename( Code = X ) %>%
  rename(Date = X.1 ) %>%
  rename(CasesPerMillion = X.3) %>%
  filter(row_number() > 1) %>%
  subset(select = c(1,3,5)) %>%
  mutate( country = as.character(country) ) %>%
  mutate(Date = mdy(Date)) %>%
  mutate(CasesPerMillion = as.integer(CasesPerMillion) - 1)


```


```{r}
TidyCOVID

```



```{r}

RelevantCountryData <-
  CountryData %>%
  subset(select = c(1,2,3)) %>%
  mutate(popdensity = round(pop/area, digits = 2))

```

```{r}

MasterData <- left_join(TidyCOVID, RelevantCountryData)

```



```{r}

MasterData <-
  MasterData %>%
  filter(country != "Africa",
         country != "Asia",
         country != "Europe",
         country != "North America",
         country != "Oceania",
         country != "South America",
         country != "World"
         ) %>%
  mutate("Cases" = (CasesPerMillion * round(pop/1000000, digits = 0)))
  
  
  MasterData
```



```{r}

FirstInstance <-
  MasterData %>%
  filter(Cases != 0) %>%
  group_by(country) %>%
  summarise(beginningofspread = min(Date))
  
FirstInstance


```






```{r}

DailySpread <-
  left_join(MasterData, FirstInstance) %>%
  filter(Date == "2020-04-05") %>%
  mutate(dayselapsed = Date - beginningofspread) %>%
  mutate(dailyspread = Cases / as.numeric(dayselapsed) ) %>%
  arrange(desc(dailyspread))

```



```{r}

MasterData <-
  left_join(MasterData, DailySpread)

```

```{r}


ggplot(data=MasterData,aes(x=pop,y=dailyspread))+geom_point() 



```




```{r}
MasterData

```


```{r}

MasterData %>%
  group_by(Date) %>%
  summarise(totalcases = sum(Cases, na.rm=T)) %>%
  ggplot(aes(x = Date, y = totalcases)) + 
  geom_point()

```







```{r}
  
MasterData %>%
  arrange(desc(dailyspread)) %>%
  head(20) %>%
  ggplot(aes(x = reorder(country, desc(dailyspread)), y= dailyspread)) +
  geom_bar(stat="identity", position = 'stack', width=.9) +
  theme(axis.text.x=element_text(angle = 60, hjust = 1)) +
  scale_y_continuous(labels = function(x) format(x, scientific = FALSE)) +
  xlab("Country") +
  ylab("Spread of COVID-19 Cases Per Day")



```










